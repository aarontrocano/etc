<#
    Unregex the variable / Un regex the variable

    The about_Regular_Expressions help file is a decent place to start. 
    Also helpful http://www.regular-expressions.info/ 
#>
$regexGroups = 'CN=Deny Amynta AMT Shared Drive EDW,OU=SecurityGroups,OU=Amynta,OU=Divestitures,OU=_HOLD,DC=amtrustservices,DC=com|CN=Amynta Mobile Disclaimer Exemption,OU=Amynta Mobile Disclaimer Exemption,OU=SecurityGroups,OU=Amynta,OU=Divestitures,OU=_HOLD,DC=amtrustservices,DC=com|CN=AMYNTA GLOBAL USERS,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=AmyntaGroup Employees,OU=AMYNTA_TECMO,OU=NON-Employee,DC=amtrustservices,DC=com|CN=AMYNTA Lakewood,OU=Groups,OU=AMYNTA_TECMO,OU=NON-Employee,DC=amtrustservices,DC=com|CN=Email External Tag,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=AMYNTA Managers,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=Risk Analytics Users,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=AMYNTA US Employees,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=AMYNTAAllEmployees,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=SW_PhishAlert,OU=Software Deployments,OU=SCCM,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=AmTrust NA Employees,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=LKW_Sales_R,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=LKW_QA_RW,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=LKW_1099_RW,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=AmTrust Managers_US,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=RDS Users AMGen,OU=PROD,OU=RDS,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=KnowBe4_Access,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=LKW_Shared_Claims_RW,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=ThinkTankList,OU=Distribution,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Lakewood Claims Signature Exclusions,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=LKW-KMC545e-01,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=LKW-KM454e-01,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=LKW-HPLJ605-01,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=LKW_Claims_Lakewood_WS(I),OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=LKW_Warranty_WebShare,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=LKW_Shared_Lakewood_WS(J),OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=LKW_SarReports_Lakewood_WS(T),OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=LKW_Public_Lakewood_WS(S),OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=LKW_GroupDir_Lakewood_WS(Y),OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=LKW_GroupDir_Lakewood_WS(O),OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=LKW_DS_Custom,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=WS_Emailer_Users,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=WS_Electronic_Payment_Gateway,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Lakewood Operations,OU=MailEnabledSecurity,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=RightFax Users,OU=Cleveland,OU=Global Security Groups,DC=amtrustservices,DC=com|CN=Websense Operations,OU=Websense Security Groups,OU=Global Security Groups,DC=amtrustservices,DC=com'
$arrGroups = @()
$arrGroups = $($regexGroups -replace '\\(.)','$1' ).split('|') <#--In a regular expression, anything in parentheses (with no other modifiers, such as "(.)") is a capturing group.  This can be referred to later in a Replace operation by a dollar sign followed by the index of the capturing group (1 being the first set of parentheses in the list, etc). So the pattern I posted replaces a backslash character followed by any single character, with just that second character.--#>
$arrGroups | Format-Table


$regexGroups = 'CN=Limu_amtrust accounts,OU=PaloAlto Security Groups,OU=Global Security Groups,DC=amtrustservices,DC=com|CN=Inscodico_blocked_Outbound,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=SW-C2R-CitrixReceiver,OU=AppDeployments,OU=SCCM,OU=ClientEngineering,OU=Global Security Groups,DC=amtrustservices,DC=com|CN=Email External Tag,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=Risk Analytics Users,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=SW_PhishAlert,OU=Software Deployments,OU=SCCM,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=AmTrust NA Employees,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=Irvine Surety Users,OU=MailEnabledSecurity,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=KnowBe4_Access,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=Tower Irvine,OU=Distribution,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=ThinkTankList,OU=Distribution,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=RDS Apps Tower Internet Explorer,OU=PROD,OU=RDS,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=RDS Apps Tower Computer,OU=PROD,OU=RDS,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=RDS Apps Tower Office,OU=PROD,OU=RDS,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=RDS Apps Tower ImageRight,OU=PROD,OU=RDS,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=AmTrust Employees,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=AmTrust US Employees,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=RDS ClaimsApps Testers,OU=PROD,OU=RDS,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=Amtrust Workers Compensation Claims,OU=Distribution,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Irvine Jamboree Claims,OU=MailEnabledSecurity,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=RDS Claims Suite,OU=PROD,OU=RDS,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=AmTrust North America Employees,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=InscoDico Vista Claims Users,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=InscoDico Specialty Unit ReadOnly,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=InscoDico Claims Users,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=InscoDico Z2. All Home Office Employees,OU=MailEnabledSecurity,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=InscoDico Z1. All Insco Employees,OU=MailEnabledSecurity,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Allow Removable Storage Access,OU=Global Security Groups,DC=amtrustservices,DC=com|CN=Deny Removable Storage Access,OU=Global Security Groups,DC=amtrustservices,DC=com|CN=RightFax Users,OU=Cleveland,OU=Global Security Groups,DC=amtrustservices,DC=com|CN=Irvine Claims,OU=MailEnabledSecurity,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=termserv,OU=Global Security Groups,DC=amtrustservices,DC=com'
$arrGroups = @()
$arrGroups = $($regexGroups -replace '\\(.)','$1' ).split('|') 
$arrGroups | Format-Table

