$regex_g_srcToMirror = 'CN=EDW_Cubes_R,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=MDM Enrollment,OU=_Hybrid,OU=Global Technology Operations,DC=amtrustservices,DC=com|CN=Reinsurance Subledger Finance,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=RDS Users HFM,OU=PROD,OU=RDS,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=Subledger_Accountants,OU=Global Security Groups,DC=amtrustservices,DC=com|CN=Regulatory_SubledgerProject_RW,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=Email External Tag,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=HRT-Shared Finance_CPP Monthly Close,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Duo VPN Users,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=Duo Users,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=Risk Analytics Users,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=AmTrust Executives,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=SW_PhishAlert,OU=Software Deployments,OU=SCCM,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=APIRViewers,OU=Ops,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=AmTrust NA Employees,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=Finance - Domestic,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=Permit Box,OU=PaloAlto Security Groups,OU=Global Security Groups,DC=amtrustservices,DC=com|CN=AmTrust Managers_US,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=RDS Users AMGen,OU=PROD,OU=RDS,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=Weekly Finance Call,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=Regulatry-FSC-RW,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=Regulatory-Reinsurance- Corporate-RW,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=2017SoxCompliance_RW,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=KnowBe4_Access,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=Dmarchive_RW,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=Offices_Majestic_ReinsuranceBillingsPDF_RW,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=HRT-Shared Finance_NonAUI-UBI_RE,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=ProjectWildcatRO,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=HRT-Shared Finance_New York_RE,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=HRT-Shared Finance_Monthly Close_RE,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=HRT-Shared Finance_Control Reports_M,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=HRT-Shared Finance_EDW_RE,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=PWCRecommendation_RW,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=PWCRecommendationGPO,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=PWCRecommendation_R,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=PWCRecommendation_Treasury_RW,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=PWCRecommendation_ActuarialReservers_RW,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=OCTCRO,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=ThinkTankList,OU=Distribution,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Finance_Ron Monthly Trends_Wesco_RW,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=ProjectTranStarRO,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=AllNYTitleRO,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=AmTrust Employees,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=Finance_Newtown,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=AmTrust US Employees,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=InsurersBoardMeetingsRO,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Covina OracleTraining,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=ProjectTPMRW,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=ProjectHudsonRW,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Acquisitions_KemperCostManagement_RW,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=RDS Wings Users,OU=PROD,OU=RDS,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=HRT-TXALICFinancialExam_M,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=HRT-KSAICKFinancialExam12_M,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Offices_LakeWood_Oracle_RW,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=GPO Dallas H DAL-FILE01 Drive Mapping,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=RDS Underwriting Suite,OU=PROD,OU=RDS,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=Websense Accounting,OU=Websense Security Groups,OU=Global Security Groups,DC=amtrustservices,DC=com|CN=Finance_Ron Monthly Trends_R,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=Finance_MonthEnd WC UBI_RW,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=Regulatory_RW,OU=File,OU=Service,OU=Security_Groups,OU=IT,DC=amtrustservices,DC=com|CN=EBS Team,OU=MailEnabledSecurity,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=tscluster,OU=Refugees,OU=Servers,OU=IT,DC=amtrustservices,DC=com|CN=Deny Removable Storage Access,OU=Global Security Groups,DC=amtrustservices,DC=com|CN=Equity Plan Participants,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=EBS AP Users-AMT,OU=Distribution,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Oracle EBS AP Clerks RO,OU=Global Security Groups,DC=amtrustservices,DC=com|CN=Oracle EBS AP Clerks,OU=Global Security Groups,DC=amtrustservices,DC=com|CN=RightFax Users,OU=Cleveland,OU=Global Security Groups,DC=amtrustservices,DC=com|CN=EBS Users-AMT,OU=MailEnabledSecurity,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Dallas Finance Managers,OU=MailEnabledSecurity,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Oracle EBS Users,OU=Global Security Groups,DC=amtrustservices,DC=com|CN=Dallas Finance,OU=MailEnabledSecurity,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=termserv,OU=Global Security Groups,DC=amtrustservices,DC=com|CN=Dallas Users,OU=MailEnabledSecurity,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Quickbooks Users,OU=Global Security Groups,DC=amtrustservices,DC=com|CN=Dallas Reports,OU=Distribution,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=AmTrust Managers,OU=Distribution,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=AmTrust Domestic Managers,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=AUI Analysts,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Finance_secure,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=UBI Managers,OU=Distribution,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Finance AP,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Finance_Mgmt,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Finance ME,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=Finance,OU=Security,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com|CN=AmTrust North America Employees,OU=Global Email Distribution Groups,OU=Global,DC=amtrustservices,DC=com|CN=UBI Users,OU=MailEnabledSecurity,OU=Groups,OU=UnderReview,OU=_HOLD,DC=amtrustservices,DC=com' #MGarrison
$g_srcToMirror = @()
$g_srcToMirror = $($regex_g_srcToMirror -replace '\\(.)','$1' ).split('|')
$Import = $g_srcToMirror
$Export = ([Environment]::GetFolderPath("Desktop")+'\groups ' + (Get-Date -format MM-dd-yyyy-HH-mm-ss) + '.txt')
$Report = @()
foreach ($g in $Import ) {
    $objGroup = $(Get-ADGroup -Identity $g -Properties SamAccountName )
    $Report += $objGroup
}
$Report | Sort-Object -Property $SamAccountName | Select-Object -ExpandProperty SamAccountName | Set-Content -Path $Export
$MGarrisonGroups = $Report | Sort-Object -Property $SamAccountName | Select-Object -ExpandProperty SamAccountName
$g_srcToMirror = $MGarrisonGroups

$Import = Get-Content ([Environment]::GetFolderPath("Desktop")+'\groups 08-08-2019-20-17-20.txt')
$g_srcToMirror = $Import

#$g_srcToMirror = (get-aduser -filter {displayname -like 'Stephanie Pilgrim' } | get-adprincipalgroupmembership -server ld9pdc01 | Sort-Object -property SamAccountName).SamAccountName  
$g_destOfMirror = (get-aduser -filter {displayname -like 'Scott Bower' } | get-adprincipalgroupmembership -server ld9pdc01 | Sort-Object -property SamAccountName).SamAccountName 
$regex_g_destOfMirror = @($g_destOfMirror | ForEach-Object {[regex]::Escape($_)}) -join '|'
$g_srcToMirror_CleanPass01 = @($g_srcToMirror | Where-Object {$_ -notmatch $regex_g_destOfMirror }) 


$sAmName = 'Cgarcia1' #Christy Garcia
$Errorlog = ([Environment]::GetFolderPath("Desktop")+'\error ' + (Get-Date -format MM-dd-yyyy-HH-mm-ss) + '.txt')


foreach ($groupSam in $g_srcToMirror_CleanPass01) {
    try {
        Add-ADGroupMember <#-WhatIf#> -Identity $groupSam -Members $sAmName -ErrorAction Stop
    }
    catch {
        Write-Verbose -message "Error adding user $($sAmName) to group $($groupSam)." -Verbose
        Add-Content -Path $Errorlog -Value ("Error adding user $($sAmName) to group $($groupSam). " + (Get-Date -format MM-dd-yyyy-HH-mm-ss) )
    }
    
}